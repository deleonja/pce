\section{Mathematical considerations} 
% Intro {{{
This section is devoted to derive the conditions a Pauli map needs to satisfy to
fulfill the CP condition i.e. that all the eigenvalues of the Choi matrix
associated to the channel \sout{must be}\janote{are} non-negative.  To do so, we calculate
and diagonalize the \janote{Choi} matrix associated with general Pauli maps, first for a
single qubit and then for $N$ qubits. We then restrict to PCEs and, for quantum
channels, associate a vector space to the set of coefficients
$\{\tau_\valpha\}$ in \eref{eq:PCE_definition}, from which we are able to
derive several important conclusions. 
% }}}
\subsection{Diagonalization of Choi matrix} 
% \subsubsection{Single qubit Pauli channels} % {{{

% \afnote{Notación para matrices densidad vectorizadas? $\varrho$ ?}
% \janote{Qué tal $\vec\rho\quad$?}
% \afnote{Por ahora uso este $\kket{\rho}$}

We now study the matrix form of the single qubit map $\mathcal{E}$ in
order to construct the associated Choi matrix. 
% and the conditions the set of parameters
% $\{\tau_{\alpha}\}$ need to satisfy in order to $\mathcal{E}$ be considered a
% quantum channel. 
To do so, we shall denote operators in the superoperator space with the symbol
$\kket{\cdot}$. For example, $\kket{\sigma_{\alpha}}$ correspond to the
vectorized elements of the Pauli basis and satisfy the usual relation 
$\bbrakket{{\sigma_{\alpha}} }{{\sigma_{\alpha'} }} = \tr
\left(\sigma_{\alpha}^{\dagger} \sigma_{\alpha'}\right) = 2
\delta_{\alpha\alpha'}$~\janote{cita?}.
In this language, 
the state reads
$\kket{\rho}=2^{-1}\sum_{\alpha=0}^{3} r_{\alpha} \kket{\sigma_{\alpha}}$
and the 
% By writing the density matrix in vector form
% $\kket{\rho}=2^{-1}\sum_{\alpha=0}^{3} r_{\alpha} \kket{\sigma_{\alpha}}$, the
matrix form of the map $\mathcal{E}$ is
% 
\begin{equation}
\hat{\mathcal{E}} = \frac{1}{2}\sum_{\alpha=0}^{3} \tau_{\alpha}
\ddyada{\sigma_{\alpha}}.
% \label{Map_Pauli}
\end{equation}
%
% where the kets $\kket{\sigma_{\alpha}}$ correspond to the vectorized elements
% of the Pauli basis and satisfy the usual relation $ \bbrakket{{\sigma_{\alpha}
% }}{{\sigma_{\alpha'} }} = \tr \left(\sigma_{\alpha}^{\dagger}
% \sigma_{\alpha'}\right) = 2 ~\delta_{\alpha\alpha'}$. 
After some steps, detailed from \eref{eq:inicio:canal:pauli} to 
\eref{Choi_Pauli_1q}, it is possible to show that the associated Choi matrix
reads
\begin{equation}
 \mathcal{D} = \frac{1}{2}\sum_{\alpha=0}^{3} \tau_{\alpha} \sigma_{\alpha}
\otimes \sigma_{\alpha}^*.
%  \label{Choi_1}
\end{equation}
Notice that, despite the similarity, $\ddyada{\sigma_{\alpha}}$ 
and $\sigma_{\alpha} \otimes \sigma_{\alpha}^*$ are different operators.
% \cpnote{Aca poner algo de que no es trivial y que se detalla en el apendice.}
% 
% Moreover, observe that $\mathcal{D}$ has the same form as the matrix
% representation of a random unitary channel, with Kraus operators given by
% $K_{\alpha}=\sqrt{\tau_{\alpha}/2}\sigma_{\alpha}$ \cite{CHRUSCINSKI20131425}.
Surprisingly, one can in fact show that $\mathcal{D}$ is diagonal in the Pauli
basis (see Appendix \ref{sec:appendix:diagonalization}  for details).
% In this way the Choi matrix $\mathcal{D}$ is diagonal in the Pauli basis (see
% Appendix for details),
%
% \begin{equation}
%  \mathcal{D} \kket{\sigma_{\alpha}}= \lambda_{\alpha} \kket{\sigma_{\alpha}},
% \end{equation}
% 
The eigenvalues are
\begin{equation}
 \lambda_{\alpha} = \frac12 \sum_{\beta=0}^3\sa_{\alpha\beta}\tau_{\beta},
\end{equation}
% or more compactly $\vec{\lambda} = \sa \vec{\tau}$, 
where 
\begin{equation}
\sa=\left(
\begin{array}{cccc}
1 &1 &1   &1   \\
 1 & 1  & -1&-1   \\
1  & -1  & 1 & -1\\
1&-1&-1&1  
\end{array}
\right).
% =\frac12\sa^{-1}.
\label{eq:1}
\end{equation}
We wish to add that one can replace $a$ with $H \otimes H$, with $H$ the
Hadamard matrix, and still diagonalize the same Choi matrix. This is due to the
fact that $a$ corresponds to a permutation of rows of  $H \otimes H$. However,
we chose \janote{to keep} $a$ \janote{as in \eqref{eq:1},} as some later considerations [see  \eref{eq:sigma_property}]
cannot be written easily in terms of $H \otimes H$.

% $\sa=2^{-1}H\otimes H$ and $H$ is the Hadamard matrix,
% \cpnote{Decidir si se usa esa $a$ o la otra para ser consistente con lo de los 
% generadores}
% %
% \begin{equation}
%  H=\begin{pmatrix}
%         1 & 1\\
%         1 & -1\\
%     \end{pmatrix}.
%  \label{Hadd_Mat}
% \end{equation}


% \cpnote{Mencionar que con la otra $a$ tambien se puede diagonalizar y la
% dejo por aca por si se nos ofrece}
% 
%  }}}
% \subsubsection{$N$ qubits} % {{{
% 

The same program can be carried out for $N$ qubits. In this case, 
the vectorized Pauli operators are 
 $\kket{\sigma_{\vec{\alpha} }}=\kket{\sigma_{\alpha_1}}\otimes\cdots
\otimes\kket{\sigma_{\alpha_N}}$\janote{aquí hay algo extraño, pues los operadores 
que utilizamos son la vectorización del producto tensorial de las paulis, no los
productos tensoriales de las paulis vectorizadas, que es lo que entiendo con la 
expresión $\kket{\sigma_{\vec{\alpha} }}=\kket{\sigma_{\alpha_1}}\otimes\cdots
\otimes\kket{\sigma_{\alpha_N}}$}, and satisfy the orthogonality relation
$\bbrakket{{\sigma_{\vec{\alpha} } }}{{\sigma_{\vec{\alpha}'} }} =  2^N
\delta_{\vec{\alpha}\vec{\alpha}'}$\janote{cita?}. The matrix representation of the
map corresponding to \eref{eq:definition:Pauli} is 
% Analogously to the single qubit case, one can define the $N$-qubits Pauli map $\mathcal{E}_N$
% % 
% \begin{equation}
% \rho \to \rho'=\mathcal{E}_N[\rho ]=\frac{1}{2^N}\sum_{\vec{\alpha}} \tau_{\vec{\alpha}} r_{\vec{\alpha}} \sigma_{\vec{\alpha}},
% % \label{Pauli_Map}
% \end{equation}
% % 
% with $-1\leq \tau_{\vec{\alpha}} \leq 1$. 
% % 
% In this case the density matrix in vector form holds 
% % 
% \begin{equation}
%  \kket{\rho}=\frac{1}{2^N}\sum_{\vec{\alpha}} r_{\vec{\alpha}} \kket{\sigma_{\vec{\alpha} }},
% \end{equation}
% where $\kket{\sigma_{\vec{\alpha} }}=\kket{\sigma_{\alpha_1}}\otimes\dots
% \otimes\kket{\sigma_{\alpha_N}}$, and satisfy the usual orthogonality relation
% $\bbrakket{{\sigma_{\vec{\alpha} } }}{{\sigma_{\vec{\alpha}'} }} = \tr
% \left(\sigma_{\vec{\alpha}}^{\dagger} \sigma_{\vec{\alpha}'}\right) = 2^N
% ~\delta_{\vec{\alpha}\vec{\alpha}'}$. The matrix representation of this map is
% given by
\begin{equation}
\hat{\mathcal{E}}_N = \frac{1}{2^N}\sum_{\vec{\alpha}} \tau_{\vec{\alpha}} \ddyada{\sigma_{\vec{\alpha} }}.
% \label{Map_Pauli}
\end{equation}
As in the previous case, the Choi matrix $\mathcal{D}_N$ may be written in
terms of tensor products of Pauli matrices
\begin{equation}
 \mathcal{D}_N 
  = \frac{1}{2^N}\sum_{\vec{\alpha}} \tau_{\vec{\alpha}}
       \bigotimes_{j=1}^N \sigma_{\alpha_j} \otimes \sigma_{\alpha_j}^*.
%  \label{Choi_1}
\end{equation}
This superoperator is again diagonal in the (multi-qubit) Pauli basis, with the 
eigenvalue corresponding to 
$ \kket{\sigma_{\vec{\alpha} }}$ given by 
% 
% After several steps, it is possible to prove that analogously to the single qubit case, $\mathcal{D}_N$ is diagonal in the $N$-qubits Pauli basis
% \begin{equation}
%  \mathcal{D}_N \kket{\sigma_{\vec{\alpha} }}
%    = \lambda_{\vec{\alpha}} \kket{\sigma_{\vec{\alpha} }},
% \end{equation}
% with eigenvalues $\lambda_{\vec{\alpha}}$ given by 
\begin{equation}
 \lambda_{\valpha} = \frac{1}{2^N} \sum_{\vbeta} \san_{\valpha\vbeta}\tau_{\vbeta},
\label{eq:lambda:is:A:tau}
\end{equation}
where 
\begin{equation}
 \san=\sa^{\otimes N}
% =\frac{1}{2^N}\left(H\otimes H\right)^{\otimes N}=\left(\frac{H}{\sqrt{2}}\right)^{\otimes 2N}.
\end{equation}
Again, the proofs are provided in appendix \ref{sec:appendix:diagonalization}. We wish 
to add that we could diagonalize $\mathcal{D}_N$ with $H^{\otimes 2N}$ instead of
$a^N$, which might be more convenient for other applications.\janote{en una 
iteración posterior del artículo completo quizás es buena idea enmarcar más esto
último de la otra a, ya que puede ser de interés en alguna aplicación}
% \cpnote{Mencionar que con la otra $a$ tambien se puede diagonalizar para $N$ 
% qubits.}
% (Proofs in an appendix using binary indices XD)
% }}}



